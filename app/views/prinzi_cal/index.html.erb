<h1>Verfügbarkeits Verwaltung von <%= @user.name %></h1>
<% if notice %>
  <p id = "notice"><%= notice %></p>
<% end %>
<p>KW <%= @kal_woche %> ist: <%= week_dates(@kal_woche) %></P>
<div class="mtb_woche">
  <div class="navi_zurück"><%= link_to '<< Vorherige Woche', prinzi_cal_index_path(woche: "#{@kal_woche.to_i - 1}"), method: :get %></div>
  <div class="navi_vor"><%= link_to 'Nächste Woche >>', prinzi_cal_index_path(woche: "#{@kal_woche.to_i + 1}"), method: :get %></div>
  <div class="titel">Uhrzeit</div>
  <div class="titel">Mo <%= @wochen_datums[0]%></div>
  <div class="titel">Di <%= @wochen_datums[1]%></div>
  <div class="titel">Mi <%= @wochen_datums[2]%></div>
  <div class="titel">Do <%= @wochen_datums[3]%></div>
  <div class="titel">Fr <%= @wochen_datums[4]%></div>
  <div class="titel">Sa <%= @wochen_datums[5]%></div>
  <div class="titel">So <%= @wochen_datums[6]%></div>
  <%= render partial: "verf_user", locals: {verfugbarkeiten: @wochen_auslastung[@user]} %>
  <div class="verfügbarkeit">Aktionen</div>
  <% @wochen_datums.each do |tag| %>
    <div class="verfügbarkeit">
      <%= form_tag(controller: "prinzi_cal", action: "create", method: :post) do %>
        <%= hidden_field_tag("verfugbarkeit[status]", "verfügbar") %>
        <%= hidden_field_tag("verfugbarkeit[start]", Time.mktime(tag.year, tag.month, tag.day, 9)) %>
        <%= hidden_field_tag("verfugbarkeit[ende]", Time.mktime(tag.year, tag.month, tag.day, 19)) %>
        <%= submit_tag "Verf. ganzer Tag" %>
      <% end %>
      <%= form_tag(controller: "prinzi_cal", action: "create", method: :post) do %>
        <%= hidden_field_tag("verfugbarkeit[status]", "abwesend") %>
        <%= hidden_field_tag("verfugbarkeit[start]", Time.mktime(tag.year, tag.month, tag.day, 9)) %>
        <%= hidden_field_tag("verfugbarkeit[ende]", Time.mktime(tag.year, tag.month, tag.day, 19)) %>
        <%= submit_tag "Abw. ganzer Tag" %>
      <% end %>
      <%= form_tag(controller: "prinzi_cal", action: "create", method: :post) do %>
        <%= hidden_field_tag("verfugbarkeit[status]", "fragen") %>
        <%= hidden_field_tag("verfugbarkeit[start]", Time.mktime(tag.year, tag.month, tag.day, 9)) %>
        <%= hidden_field_tag("verfugbarkeit[ende]", Time.mktime(tag.year, tag.month, tag.day, 19)) %>
        <%= submit_tag "Fr. ganzer Tag" %>
      <% end %>
    </div>
  <% end %>
</div>
<div>Verfügbarkeiten</div>
<table>
  <tbody>
    <tr>
      <td><%= button_to 'Erzeuge Verfügbarkeit', new_buchung_prinzi_path, action: "create", method: :get %></td>
    </tr>
    <tr>
      <td>
        <div class="ereignis_frame">
          <% @verfugbarkeits.each do |verfugbarkeit| %>
            <%= render partial: "ereigniss_liste", locals: { verfugbarkeit: verfugbarkeit } %>
          <% end %>
        </div>
      </td>
      <td></td>
    </tr>
    <tr>
      <td></td>
    </tr>
  </tbody>
</table>